# 事件风暴

# 用例分析与关系推导

我们经过对一个业务过程总是可以识别出有哪些人、角色会参与到业务过程的相关活动中，我们使用 UML 建模方法。一般我们会用 Use Case 图进行表达，Use Case 图会包含这些元素：

- Actor：常见的翻译包括“参与者、执行者、主角”等等。
- Use Case：在不展现一个系统或子系统内部结构的情况下，对系统或子系统的某个连贯的功能单元的定义和描述。

其中 Use Case 还会包含这些信息：名称、简单描述、关系、活动图和状态图、前置条件、后置条件等等。以一个简单的用户账号管理为例，我们绘制的整体 Use Case 图如下：

![](https://i.postimg.cc/q7chY3SD/image.png)

比如让你设计一个中介系统，一个典型的 User Story 可能是“小明去找工作，中介说你留个电话，有工作机会我会通知你”，这里面的关键名词很可能就是我们需要的领域对象：

- 小明是求职者。
- 电话是求职者的属性。
- 中介包含了中介公司，中介员工两个关键对象。
- 工作机会肯定也是关键领域对象；
- 通知这个动词暗示我们这里用观察者模式会比较合适。

然后再梳理一下领域对象之间的关系，一个求职者可以应聘多个工作机会，一个工作机会也可以被多个求职者应聘，M2M 的关系，中介公司可以包含多个员工，O2M 的关系。对于这样简单的场景，这个建模就差不多了。

譬如典型的银行转账的案例中，商户从自己的 MPA 账户转出 1 美元给用户余额账户。其他的业务描述还包括：商户转账可以透支，但转账金额不能超出可用金额；转账将向商家收取一定费用；商户或用户都必须是正常状态。

## 词法分析

分析用例句子中的词语及词性，提取句中的名词，找出业务主体。参考的词性列举如下：

![](https://i.postimg.cc/xdFxd6zr/image.png)

譬如上述描述中的名词有：

- 商户：资金流出方
- 账户：MPA 账户和余额账户
- 用户：资金流入方
- 金额：100 美元，由量词和单位组成
- 订单：资金业务单据
- 单位（币种）：和数量词共同组成金额

## 句法分析

分析用例句子中词语的关系，构建业务主体关系。参考的句法：

![](https://i.postimg.cc/1XxZ8mqZ/image.png)

- 商户拥有 MAP 账户
- 账户被商户与用户拥有
- 用户拥有余额账户
- 订单拥有金额
- 金额由数据及单位组成
- 账户拥有多个类型

基于此我们可以去建立业务主体间的关系：

![](https://i.postimg.cc/xTGDxVW6/image.png)
